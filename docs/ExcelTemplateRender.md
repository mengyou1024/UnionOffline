# 报表模板规则

## 1.说明

报表导出时, 软件会查找安装目录下`excel_template/AScan/`和`excel_template/TOFD_PE/`目录中的报表模板进行导出

```powershell
excel_templates/
├── AScan 							# A扫界面中的报表导出
│   ├── T_仪器性能.xlsx 					  # 仪器性能所使用的报表模板
│   ├── T_报表生成.xlsx						  # 通用仪器所使用的报表模板(PXUT-330N)
│   ├── T_报表生成_CameraImageSpecial.xlsx	  # 带摄像头仪器使用的报表模板(PXUT-390N、PXUT-T8)
│   └── T_报表生成_RailWeldSpecial.xlsx		 # 钢轨焊缝特化版本使用的报表模板(PXUT-390、 PXUT-T8钢轨版本)
└── TOFD_PE 						# TOFD/PE界面中的报表导出
    └── T_报表生成.xlsx 					 # 所有TOFD/PE使用的报表模板
```

## 2.渲染规则

### 字符串替换

​	导出报表时，软件会将`${xxx}`形式的字符串替换为指定变量

- 如  `${声速}`会被替换为: `5920m/s`

### 图像插入

​	导出报表时，软件在`$<xxx>`形式所在的单元格处插入图片，并删除原有字符串

	- `$<"name": "AScan", "width": 480, "height": 320>`, 会在单元格位置插入A扫图片，并将宽度和高度调整为指定值
	- `$<"name": "AScan", "width": 480>`, 会在单元格位置插入A扫图片，并将宽度调整为指定值(保持图片的横纵比例)
	- `$<"name": "AScan", "height": 320>`, 会在单元格位置插入A扫图片，并将宽高调整为指定值(保持图片的横纵比例)

## 3.可使用变量

### 通用

| 可使用变量 |
| :--------: |
|  检测日期  |
|  晶片尺寸  |
|  探头类型  |
|    前沿    |
|  探头K值   |
|   折射角   |
|    零点    |
|  仪器型号  |
|   灵敏度   |
|  回波抑制  |
|  回波延时  |
|  声程范围  |
|    声速    |
|    距离    |
|    水平    |
|    垂直    |
|    当量    |
|    高度    |

### PXUT-390额外

| 可使用变量 |
| :--------: |
|  钢轨日期  |
|   K范围    |
|    线名    |
|    行别    |

## 4. 注意事项

1. 模板中所使用的 `$、"、:、{、}、,、<、>`等符号均**必须是英文符号**
