From b0b69845af49f8cae6d45dbe6aad0ae98764eeb2 Mon Sep 17 00:00:00 2001
From: mengyou <1523038073@qq.com>
Date: Tue, 14 May 2024 16:49:59 +0800
Subject: [PATCH] =?UTF-8?q?patch:=20=E6=9B=B4=E6=96=B0=E9=92=A2=E8=BD=A8?=
 =?UTF-8?q?=E7=84=8A=E7=BC=9D=E8=A1=A5=E4=B8=81?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 CMakeLists.txt                    |  2 +-
 cmake/FindMorose.cmake            |  1 +
 resource/qml/About.qml            |  2 +-
 resource/qml/main.qml             |  3 ++-
 script/pack-installer-msvc.iss.in |  2 +-
 script/pack-installer.iss.in      |  2 +-
 src/common/common.cpp             | 14 +++++++-------
 translations/UnionOffline_en.ts   |  2 +-
 8 files changed, 15 insertions(+), 13 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 4199914..b82b649 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,6 +1,6 @@
 cmake_minimum_required(VERSION 3.20)
 
-project(UnionOffline LANGUAGES CXX)
+project(RailWeldOffline LANGUAGES CXX)
 
 set(CMAKE_CXX_STANDARD 20)
 set(NUMCPP_NO_USE_BOOST ON)
diff --git a/cmake/FindMorose.cmake b/cmake/FindMorose.cmake
index 9eac144..0dfc8fe 100644
--- a/cmake/FindMorose.cmake
+++ b/cmake/FindMorose.cmake
@@ -22,6 +22,7 @@ macro(morose_main_setup)
                     "the git describe is use for varible `APP_VERSION`"
                 )
             else()
+                string(REGEX MATCH "v[^-]+" APP_VERSION ${APP_VERSION})
                 message(STATUS "APP VERSION:" ${APP_VERSION})
             endif()
 
diff --git a/resource/qml/About.qml b/resource/qml/About.qml
index c1b8bdb..300c29b 100644
--- a/resource/qml/About.qml
+++ b/resource/qml/About.qml
@@ -40,7 +40,7 @@ ApplicationWindow {
                 Layout.fillWidth: true
                 verticalAlignment: Qt.AlignVCenter
                 font.pixelSize: 18
-                text: `通用离线分析软件 ${MOROSE_APP_VERSION}`
+                text: `钢轨焊缝离线分析软件 ${MOROSE_APP_VERSION}`
             }
             Text {
                 Layout.fillWidth: true
diff --git a/resource/qml/main.qml b/resource/qml/main.qml
index f68f426..ef84c1e 100644
--- a/resource/qml/main.qml
+++ b/resource/qml/main.qml
@@ -18,7 +18,7 @@ ApplicationWindow {
     minimumHeight: 870
     visible: true
     id: wnd_main
-    title: qsTr("通用离线分析软件")
+    title: qsTr("钢轨焊缝离线分析软件")
 
     property string mainUIType: "Unknow"
 
@@ -67,6 +67,7 @@ ApplicationWindow {
                     img_src: "qrc:/img/USB_51.png"
                     btn_txt: qsTr("通讯")
                     height: parent.height
+                    visible: false
                     onClicked: {
                         var comp = Qt.createComponent("Communicate.qml")
                         if (comp.status === Component.Ready) {
diff --git a/script/pack-installer-msvc.iss.in b/script/pack-installer-msvc.iss.in
index 560f60d..dd8a63d 100644
--- a/script/pack-installer-msvc.iss.in
+++ b/script/pack-installer-msvc.iss.in
@@ -13,7 +13,7 @@
 [Setup]
 ; 注意:AppId的值唯一标识该应用程序。不要在其他应用程序的安装程序中使用相同的AppId值。
 ; (要生成新的GUID，请在IDE中单击Tools | generate GUID。)
-AppId={{65C66E39-C539-4D2D-9DEF-664965A9C599}
+AppId={{E966BD6F-B7A2-41DD-A96F-FE4DAD7F994E}
 AppName={#MyAppName}
 AppVersion={#MyAppVersion}
 ;AppVerName={#MyAppName} {#MyAppVersion}
diff --git a/script/pack-installer.iss.in b/script/pack-installer.iss.in
index 769681a..080f63f 100644
--- a/script/pack-installer.iss.in
+++ b/script/pack-installer.iss.in
@@ -13,7 +13,7 @@
 [Setup]
 ; 注意:AppId的值唯一标识该应用程序。不要在其他应用程序的安装程序中使用相同的AppId值。
 ; (要生成新的GUID，请在IDE中单击Tools | generate GUID。)
-AppId={{65C66E39-C539-4D2D-9DEF-664965A9C599}
+AppId={{E966BD6F-B7A2-41DD-A96F-FE4DAD7F994E}
 AppName={#MyAppName}
 AppVersion={#MyAppVersion}
 ;AppVerName={#MyAppName} {#MyAppVersion}
diff --git a/src/common/common.cpp b/src/common/common.cpp
index 69e1cda..c02894a 100644
--- a/src/common/common.cpp
+++ b/src/common/common.cpp
@@ -142,18 +142,18 @@ void Morose::registerVariable(QQmlContext* context) {
 }
 
 void Morose::registeAllAScanFileSelector() {
-    Union::AScan::AScanFileSelector::Instance().RegistReader("*.ldat", "390N、T8连续图像", Union::__390N_T8::LDAT::FromFile);
-    Union::AScan::AScanFileSelector::Instance().RegistReader("*.vdata", "390N、T8带摄像头图像", Union::__390N_T8::VDATA::FromFile);
-    Union::AScan::AScanFileSelector::Instance().RegistReader("*.json", "390N、T8单幅图像", Union::__390N_T8::T8_390N_JSON::FromFile);
-    Union::AScan::AScanFileSelector::Instance().RegistReader("*.das", "330单幅图像", Union::__330::DASType::FromFile);
+    // Union::AScan::AScanFileSelector::Instance().RegistReader("*.ldat", "390N、T8连续图像", Union::__390N_T8::LDAT::FromFile);
+    // Union::AScan::AScanFileSelector::Instance().RegistReader("*.vdata", "390N、T8带摄像头图像", Union::__390N_T8::VDATA::FromFile);
+    // Union::AScan::AScanFileSelector::Instance().RegistReader("*.json", "390N、T8单幅图像", Union::__390N_T8::T8_390N_JSON::FromFile);
+    // Union::AScan::AScanFileSelector::Instance().RegistReader("*.das", "330单幅图像", Union::__330::DASType::FromFile);
     Union::AScan::AScanFileSelector::Instance().RegistReader("*.daa", "390钢轨焊缝单幅图像", Union::__390::DAAType::FromFile);
     Union::AScan::AScanFileSelector::Instance().RegistReader("*.DAT", "330连续图像", Union::__330::DATType::FromFile);
-    Union::AScan::AScanFileSelector::Instance().RegistReader("*.cod", "330串口数据", Union::__330::Serial_330::FromFile);
+    // Union::AScan::AScanFileSelector::Instance().RegistReader("*.cod", "330串口数据", Union::__330::Serial_330::FromFile);
 }
 
 void Morose::registeAllTofdPeFileSelector() {
-    Union::TOFD_PE::TofdPeFileSelector::Instance().RegistReader("*.tpe", "TOFD/PE图像", Union::TOFD_PE::TPE::TpeType::FromFile);
-    Union::TOFD_PE::TofdPeFileSelector::Instance().RegistReader("*.tof", "TOFD/PE图像", Union::TOFD_PE::TPE::TpeType::FromFile);
+    // Union::TOFD_PE::TofdPeFileSelector::Instance().RegistReader("*.tpe", "TOFD/PE图像", Union::TOFD_PE::TPE::TpeType::FromFile);
+    // Union::TOFD_PE::TofdPeFileSelector::Instance().RegistReader("*.tof", "TOFD/PE图像", Union::TOFD_PE::TPE::TpeType::FromFile);
 }
 
 QJsonObject& Morose::getGlobalEnvironment() {
diff --git a/translations/UnionOffline_en.ts b/translations/UnionOffline_en.ts
index 209f3ee..331a2cb 100644
--- a/translations/UnionOffline_en.ts
+++ b/translations/UnionOffline_en.ts
@@ -521,7 +521,7 @@
     <name>main</name>
     <message>
         <location filename="../resource/qml/main.qml" line="20"/>
-        <source>通用离线分析软件</source>
+        <source>钢轨焊缝离线分析软件</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
-- 
2.43.0.windows.1

