From 904ebbeef8959b8f81bc2d25952813e375318db1 Mon Sep 17 00:00:00 2001
From: mengyou <1523038073@qq.com>
Date: Wed, 12 Jun 2024 08:44:41 +0800
Subject: [PATCH] chore: update railweld patch

---
 CMakeLists.txt                    | 2 +-
 cmake/FindMorose.cmake            | 3 ++-
 morose_config.h.in                | 4 ++--
 resource/qml/About.qml            | 2 +-
 resource/qml/main.qml             | 3 ++-
 script/pack-installer-msvc.iss.in | 2 +-
 script/pack-installer.iss.in      | 2 +-
 translations/UnionOffline_en.ts   | 2 +-
 8 files changed, 11 insertions(+), 9 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 5d4a44a..32c2b13 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,6 +1,6 @@
 cmake_minimum_required(VERSION 3.20)
 
-project(UnionOffline LANGUAGES CXX)
+project(RailWeldOffline LANGUAGES CXX)
 
 set(CMAKE_CXX_STANDARD 20)
 set(NUMCPP_NO_USE_BOOST ON)
diff --git a/cmake/FindMorose.cmake b/cmake/FindMorose.cmake
index 0fce0fe..11a2e93 100644
--- a/cmake/FindMorose.cmake
+++ b/cmake/FindMorose.cmake
@@ -465,7 +465,8 @@ add_custom_target(
     COMMAND powershell "Copy-Item -Force -Recurse ${CMAKE_SOURCE_DIR}/.git ${CMAKE_SOURCE_DIR}/output/archive/.git;\
     cd ${CMAKE_SOURCE_DIR}/output/archive/; \
     git reset --hard;\
-    git submodule update --init --recursive" > nul
+    git submodule update --init --recursive;\
+    git apply ./patchs/RailWeldSpecial.patch" > nul
     COMMAND echo "{\
 \"APP_VERSION\":\"${APP_VERSION}\",\
 \"APP_URL\": \"${APP_URL}\",\
diff --git a/morose_config.h.in b/morose_config.h.in
index f724039..5bb7228 100644
--- a/morose_config.h.in
+++ b/morose_config.h.in
@@ -2,5 +2,5 @@
 
 #define APP_VERSION                    "@APP_VERSION@"
 
-#define ENABLE_UNION_GENERIC           (1) ///< 使用通用仪器接口
-#define ENABLE_RAILWELE_SPECIALIZATION (0) ///< 使用钢轨焊缝特化接口
+#define ENABLE_UNION_GENERIC           (0) ///< 使用通用仪器接口
+#define ENABLE_RAILWELE_SPECIALIZATION (1) ///< 使用钢轨焊缝特化接口
diff --git a/resource/qml/About.qml b/resource/qml/About.qml
index c1b8bdb..300c29b 100644
--- a/resource/qml/About.qml
+++ b/resource/qml/About.qml
@@ -40,7 +40,7 @@ ApplicationWindow {
                 Layout.fillWidth: true
                 verticalAlignment: Qt.AlignVCenter
                 font.pixelSize: 18
-                text: `通用离线分析软件 ${MOROSE_APP_VERSION}`
+                text: `钢轨焊缝离线分析软件 ${MOROSE_APP_VERSION}`
             }
             Text {
                 Layout.fillWidth: true
diff --git a/resource/qml/main.qml b/resource/qml/main.qml
index 6eca0c4..9ef3133 100644
--- a/resource/qml/main.qml
+++ b/resource/qml/main.qml
@@ -18,7 +18,7 @@ ApplicationWindow {
     minimumHeight: 870
     visible: true
     id: wnd_main
-    title: qsTr("通用离线分析软件")
+    title: qsTr("钢轨焊缝离线分析软件")
 
     property string mainUIType: "Unknow"
 
@@ -70,6 +70,7 @@ ApplicationWindow {
                     img_src: "qrc:/img/USB_51.png"
                     btn_txt: qsTr("通讯")
                     height: parent.height
+                    visible: false
                     onClicked: {
                         var comp = Qt.createComponent("Communicate.qml")
                         if (comp.status === Component.Ready) {
diff --git a/script/pack-installer-msvc.iss.in b/script/pack-installer-msvc.iss.in
index 5c61f38..adddebf 100644
--- a/script/pack-installer-msvc.iss.in
+++ b/script/pack-installer-msvc.iss.in
@@ -13,7 +13,7 @@
 [Setup]
 ; 注意:AppId的值唯一标识该应用程序。不要在其他应用程序的安装程序中使用相同的AppId值。
 ; (要生成新的GUID，请在IDE中单击Tools | generate GUID。)
-AppId={{65C66E39-C539-4D2D-9DEF-664965A9C599}
+AppId={{E966BD6F-B7A2-41DD-A96F-FE4DAD7F994E}
 AppName={#MyAppName}
 AppVersion={#MyAppVersion}
 ;AppVerName={#MyAppName} {#MyAppVersion}
diff --git a/script/pack-installer.iss.in b/script/pack-installer.iss.in
index 4e68190..62997aa 100644
--- a/script/pack-installer.iss.in
+++ b/script/pack-installer.iss.in
@@ -13,7 +13,7 @@
 [Setup]
 ; 注意:AppId的值唯一标识该应用程序。不要在其他应用程序的安装程序中使用相同的AppId值。
 ; (要生成新的GUID，请在IDE中单击Tools | generate GUID。)
-AppId={{65C66E39-C539-4D2D-9DEF-664965A9C599}
+AppId={{E966BD6F-B7A2-41DD-A96F-FE4DAD7F994E}
 AppName={#MyAppName}
 AppVersion={#MyAppVersion}
 ;AppVerName={#MyAppName} {#MyAppVersion}
diff --git a/translations/UnionOffline_en.ts b/translations/UnionOffline_en.ts
index 209f3ee..331a2cb 100644
--- a/translations/UnionOffline_en.ts
+++ b/translations/UnionOffline_en.ts
@@ -521,7 +521,7 @@
     <name>main</name>
     <message>
         <location filename="../resource/qml/main.qml" line="20"/>
-        <source>通用离线分析软件</source>
+        <source>钢轨焊缝离线分析软件</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
-- 
2.43.0.windows.1

